<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CppDB: Quick Start Guide</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">CppDB
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">CppDB - SQL Connectivity Library</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Quick Start Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="codesmaple"></a>
The Code</h2>
<p>The best is to start from this example</p>
<div class="fragment"><pre class="fragment">
<span class="comment">//                                                                             </span>
<span class="comment">//  Copyright (C) 2010-2011  Artyom Beilis (Tonkikh) &lt;artyomtnk@yahoo.com&gt;     </span>
<span class="comment">//                                                                             </span>
<span class="comment">//  Distributed under:</span>
<span class="comment">//</span>
<span class="comment">//                   the Boost Software License, Version 1.0.</span>
<span class="comment">//              (See accompanying file LICENSE_1_0.txt or copy at </span>
<span class="comment">//                     http://www.boost.org/LICENSE_1_0.txt)</span>
<span class="comment">//</span>
<span class="comment">//  or (at your opinion) under:</span>
<span class="comment">//</span>
<span class="comment">//                               The MIT License</span>
<span class="comment">//                 (See accompanying file MIT.txt or a copy at</span>
<span class="comment">//              http://www.opensource.org/licenses/mit-license.php)</span>
<span class="comment">//</span>
<span class="comment"></span><span class="preprocessor">#include &lt;cppdb/frontend.h&gt;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>
<span class="preprocessor">#include &lt;ctime&gt;</span>


<span class="keywordtype">int</span> main()
{
        <span class="keywordflow">try</span> {
                <a class="code" href="classcppdb_1_1session.html" title="SQL session object that represents a single connection and is the gateway to SQL database.">cppdb::session</a> sql(<span class="stringliteral">&quot;sqlite3:db=db.db&quot;</span>);
                
                sql &lt;&lt; <span class="stringliteral">&quot;DROP TABLE IF EXISTS test&quot;</span> &lt;&lt; <a class="code" href="namespacecppdb.html#a4ef7108015eb01d87073d5dc0f55488c" title="Manipulator that causes statement execution. Used as:">cppdb::exec</a>;

                sql&lt;&lt;   <span class="stringliteral">&quot;CREATE TABLE test ( &quot;</span>
                        <span class="stringliteral">&quot;   id   INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, &quot;</span>
                        <span class="stringliteral">&quot;   n    INTEGER,&quot;</span>
                        <span class="stringliteral">&quot;   f    REAL, &quot;</span>
                        <span class="stringliteral">&quot;   t    TIMESTAMP,&quot;</span>
                        <span class="stringliteral">&quot;   name TEXT &quot;</span>
                        <span class="stringliteral">&quot;)  &quot;</span> &lt;&lt; <a class="code" href="namespacecppdb.html#a4ef7108015eb01d87073d5dc0f55488c" title="Manipulator that causes statement execution. Used as:">cppdb::exec</a>;
                
                std::time_t now_time = std::time(0);
                
                std::tm now = *std::localtime(&amp;now_time);

                <a class="code" href="classcppdb_1_1statement.html" title="This class represents a prepared (or ordinary) statement that can be executed.">cppdb::statement</a> stat;
                
                stat = sql &lt;&lt; 
                        <span class="stringliteral">&quot;INSERT INTO test(n,f,t,name) &quot;</span>
                        <span class="stringliteral">&quot;VALUES(?,?,?,?)&quot;</span>
                        &lt;&lt; 10 &lt;&lt; 3.1415926565 &lt;&lt; now &lt;&lt;<span class="stringliteral">&quot;Hello &#39;World&#39;&quot;</span>;

                stat.<a class="code" href="classcppdb_1_1statement.html#a121b14744671842bcc51b0640978e17f">exec</a>();
                std::cout&lt;&lt;<span class="stringliteral">&quot;ID: &quot;</span>&lt;&lt;stat.<a class="code" href="classcppdb_1_1statement.html#a74e9285b1b1ec809169b709b2ae5bf4f">last_insert_id</a>() &lt;&lt; std::endl;
                std::cout&lt;&lt;<span class="stringliteral">&quot;Affected rows &quot;</span>&lt;&lt;stat.<a class="code" href="classcppdb_1_1statement.html#ab0875bdf7893e9bd00f5233faf27dac0">affected</a>()&lt;&lt;std::endl;
                
                stat.<a class="code" href="classcppdb_1_1statement.html#a98e3c53d169fb9db148a28dae53ce82e">reset</a>();

                stat.<a class="code" href="classcppdb_1_1statement.html#add4e469140ddd77aadc5d6c8cfb8ba11">bind</a>(20);
                stat.<a class="code" href="classcppdb_1_1statement.html#ace3ef49f6e19e394778c842ef97af5a9">bind_null</a>();
                stat.<a class="code" href="classcppdb_1_1statement.html#add4e469140ddd77aadc5d6c8cfb8ba11">bind</a>(now);
                stat.<a class="code" href="classcppdb_1_1statement.html#add4e469140ddd77aadc5d6c8cfb8ba11">bind</a>(<span class="stringliteral">&quot;Hello &#39;World&#39;&quot;</span>);
                stat.<a class="code" href="classcppdb_1_1statement.html#a121b14744671842bcc51b0640978e17f">exec</a>();


                <a class="code" href="classcppdb_1_1result.html" title="This object represents query result.">cppdb::result</a> res = sql &lt;&lt; <span class="stringliteral">&quot;SELECT id,n,f,t,name FROM test&quot;</span>;

                <span class="keywordflow">while</span>(res.<a class="code" href="classcppdb_1_1result.html#a6d3a8f7e8ddf714775fb0e30b4db4fe7">next</a>()) {
                        <span class="keywordtype">double</span> f=-1;
                        <span class="keywordtype">int</span> id,k;
                        std::tm atime;
                        std::string name;
                        res &gt;&gt; <span class="keywordtype">id</span> &gt;&gt; k &gt;&gt; f &gt;&gt; atime &gt;&gt; name;
                        std::cout &lt;&lt;<span class="keywordtype">id</span> &lt;&lt; <span class="charliteral">&#39; &#39;</span>&lt;&lt;k &lt;&lt;<span class="charliteral">&#39; &#39;</span>&lt;&lt;f&lt;&lt;<span class="charliteral">&#39; &#39;</span>&lt;&lt;name&lt;&lt;<span class="charliteral">&#39; &#39;</span>&lt;&lt;asctime(&amp;atime)&lt;&lt; std::endl;
                }

                res = sql &lt;&lt; <span class="stringliteral">&quot;SELECT n,f FROM test WHERE id=?&quot;</span> &lt;&lt; 1 &lt;&lt; <a class="code" href="namespacecppdb.html#ae6ebd557a51b7bf10e81fb89a1e17edf" title="Manipulator that fetches a single row. Used as:">cppdb::row</a>;
                <span class="keywordflow">if</span>(!res.<a class="code" href="classcppdb_1_1result.html#ae94927e1328d4f3b62276f596a3434ee">empty</a>()) {
                        <span class="keywordtype">int</span> n = res.<a class="code" href="classcppdb_1_1result.html#a2857f66096d699a11f9cdba51b02ad11">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;n&quot;</span>);
                        <span class="keywordtype">double</span> f=res.<a class="code" href="classcppdb_1_1result.html#a2857f66096d699a11f9cdba51b02ad11">get</a>&lt;<span class="keywordtype">double</span>&gt;(1);
                        std::cout &lt;&lt; <span class="stringliteral">&quot;The values are &quot;</span> &lt;&lt; n &lt;&lt;<span class="stringliteral">&quot; &quot;</span> &lt;&lt; f &lt;&lt; std::endl;
                }
        }
        <span class="keywordflow">catch</span>(std::exception <span class="keyword">const</span> &amp;e) {
                std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;
                <span class="keywordflow">return</span> 1;
        }
        <span class="keywordflow">return</span> 0;
}
</pre></div><p>First we connect to the database using <a class="el" href="connstr.html">cppdb connection string</a>. Then we execute a simple sql query.</p>
<p>When you write</p>
<div class="fragment"><pre class="fragment">        sql &lt;&lt; <span class="stringliteral">&quot;DROP TABLE IF EXISTS test&quot;</span> &lt;&lt; <a class="code" href="namespacecppdb.html#a4ef7108015eb01d87073d5dc0f55488c" title="Manipulator that causes statement execution. Used as:">cppdb::exec</a>;
</pre></div><h2><a class="anchor" id="codedesc"></a>
Description</h2>
<p>You actually first prepare a statement (using first operator "&lt;&lt;") and then execute it using a <a class="el" href="namespacecppdb.html#a4ef7108015eb01d87073d5dc0f55488c" title="Manipulator that causes statement execution. Used as:">cppdb::exec</a> manipulator. In the same way we create the table we need.</p>
<p>Then we create a statement that we will use multiple times. At first we prepare a statement using operator "&lt;&lt;" and then we bind parameters to it. Note, the string is passed as is without escaping it in any way. Then we execute a statement calling stat.exec(). Note it could be done using manipulator as well in previous line, but this is just a more verbose way and probably more clean way to do it.</p>
<p>Then calling stat.last_insert_id() and stat.affected() we fetch the data about last executed statement.</p>
<p>We can use our statement again after calling <a class="el" href="classcppdb_1_1statement.html#a98e3c53d169fb9db148a28dae53ce82e">cppdb::statement::reset()</a> function. In the next statement execution we would use more "verbose" variant of binding parameters - using bind() functions of statement, and then executing it.</p>
<p>Then fetch the results we created. We prepare a query and assign it into <em>res</em> variable efficiently fetching the query result.</p>
<p>Then we iterate over result's rows using res.next(), for each row we fetch the data using operator "&gt;&gt;".</p>
<p>In the next query we select several values into a single row. We prepare a statement, bind a key 1 for the placeholder "?" and then we check if the row was actually fetched and we fetch values. We can fetch values using operator "&gt;&gt;" as above, however we can also fetch them using column names or indexes. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 23 2012 12:36:59 for CppDB by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
